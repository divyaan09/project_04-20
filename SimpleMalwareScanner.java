import java.io.*;
import java.util.*;

public class SimpleMalwareScanner {
    public static void main(String[] args) {
        String fileToScan = "sample_file.txt";
        String signatureFile = "signatures.txt";

        try {
            List<String> signatures = loadSignatures(signatureFile);
            String content = readFileContent(fileToScan);

            boolean threatDetected = false;
            for (String sig : signatures) {
                if (content.contains(sig)) {
                    System.out.println("⚠️ Malware signature found: " + sig);
                    threatDetected = true;
                }
            }

            if (!threatDetected) {
                System.out.println("✅ No malware signatures detected.");
            }

        } catch (IOException e) {
            System.out.println("Error: " + e.getMessage());
        }
    }

    public static List<String> loadSignatures(String filePath) throws IOException {
        List<String> signatures = new ArrayList<>();
        BufferedReader reader = new BufferedReader(new FileReader(filePath));
        String line;

        while ((line = reader.readLine()) != null) {
            signatures.add(line.trim());
        }

        reader.close();
        return signatures;
    }

    public static String readFileContent(String filePath) throws IOException {
        StringBuilder content = new StringBuilder();
        BufferedReader reader = new BufferedReader(new FileReader(filePath));
        String line;

        while ((line = reader.readLine()) != null) {
            content.append(line).append("\n");
        }

        reader.close();
        return content.toString();
    }
}
